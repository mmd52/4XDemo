setwd("D:/MDS/4XDemo/4X")
#Author @ Mohammed 06/05/2018
#Code used to Fetch/install/Load all libraries required
print("============== Beginning to load libraries  ===================")
setwd("D:/MDS/4XDemo/4X")
#Function To check if
checkInstallLoad <- function(libName)
{
if(!require(libName, character.only=TRUE))
{
install.packages(libName)
require(libName, character.only=TRUE)
}
}
checkInstallLoad("data.table")
checkInstallLoad("Matrix")
checkInstallLoad("Metrics")
checkInstallLoad("stringr")
checkInstallLoad("lubridate")
checkInstallLoad("ggplot2")
checkInstallLoad("pROC")
checkInstallLoad("caret")
checkInstallLoad("caretEnsemble")
checkInstallLoad("e1071")
checkInstallLoad("randomForest")
checkInstallLoad("xgboost")
checkInstallLoad("rpart")
checkInstallLoad("C50")
checkInstallLoad("adabag")
checkInstallLoad("arules")
checkInstallLoad("ROCR")
checkInstallLoad("nnet")
checkInstallLoad("car")
checkInstallLoad("Ckmeans.1d.dp")
checkInstallLoad("psych")
print("============== Completed loading libraries  ===================")
source("Libraries.R")
dat<-read.csv('4Xdata.csv',header=TRUE)
View(head(dat))
sum(dat$Quantity..units.)
sum(dat$Turnover..EURO.)
summary(dat)
sum(dat$Turnover)
summary(dat)
dat[is.na(dat)] <- 0
dat$Plant
dat$Plant<-as.factor(dat$Plant)
dat$Product.Line<-as.factor(dat$Product.Line)
dat$Product.Type<-as.factor(dat$Product.Type)
dat$Turnover.Range<-as.factor(dat$Turnover.Range)
dat$Geographical.Area<-as.factor(dat$Geographical.Area)
summary(dat)
names(dat)<-c("Plant","Quantity_units","Turnover_EURO","Cost_of_Goods_Sold_EURO",
"Total_Cost_of_Distribution","Sales_Transportation","Packing",
"Distribution_Activities","Trading_Transportation","Custom_Duties_Trading",
"Warehouse_Rent","Outbound_Logistics_Local_Branches",
"Total_Customer_Order_Management_Costs","Sales_Comissions","Sales_Development",
"Offer_Development","Order_Management","Customer_Service",
"Manage_Account_Receivables","Customer_Order_Management_Local_Branches",
"Customer_related_Issues_Costs","Rebate","Bad_Debt","Cost_of_Poor_Quality",
"Total_Operations_Costs","Manufacturing_Costs","Internal_Logistics_Costs",
"Supply_Chain_Management_Costs","Transportations","Manage_Orders_to_Suppliers",
"Inbound_Logistics","Inspect_goods","Manage_Foreign_Relationships","Product_Line",
"Product_Type","N_Parts","Assembly_Labour_Minutes","Machinery_Minutes",
"Number_of_Deliveries","Average_Delivery_Batch_Size_units","Customer_Class",
"Turnover_Range_EURO","Geographical_Area")
View(head(dat))
summary(dat)
dat$Assembly_Labour_Minutes<-as.numeric(dat$Assembly_Labour_Minutes)
dat$Machinery_Minutes<-as.numeric(dat$Machinery_Minutes)
dat[is.na(dat)] <- 0
summary(dat)
summary(dat)
rm(list=ls())
source("Libraries.R")
rm(checkInstallLoad)
source("Libraries.R")
dat<-read.csv('4Xdata_Base.csv',header=TRUE)
View(head(dat))
sum(dat$Quantity..units.)
sum(dat$Turnover)
summary(dat)
dat[is.na(dat)] <- 0
dat$Plant<-as.factor(dat$Plant)
dat$Product.Line<-as.factor(dat$Product.Line)
dat$Product.Type<-as.factor(dat$Product.Type)
dat$Turnover.Range<-as.factor(dat$Turnover.Range)
dat$Geographical.Area<-as.factor(dat$Geographical.Area)
summary(dat)
names(dat)<-c("Plant","Quantity_units","Turnover_EURO","Cost_of_Goods_Sold_EURO",
"Total_Cost_of_Distribution","Sales_Transportation","Packing",
"Distribution_Activities","Trading_Transportation","Custom_Duties_Trading",
"Warehouse_Rent","Outbound_Logistics_Local_Branches",
"Total_Customer_Order_Management_Costs","Sales_Comissions","Sales_Development",
"Offer_Development","Order_Management","Customer_Service",
"Manage_Account_Receivables","Customer_Order_Management_Local_Branches",
"Customer_related_Issues_Costs","Rebate","Bad_Debt","Cost_of_Poor_Quality",
"Total_Operations_Costs","Manufacturing_Costs","Internal_Logistics_Costs",
"Supply_Chain_Management_Costs","Transportations","Manage_Orders_to_Suppliers",
"Inbound_Logistics","Inspect_goods","Manage_Foreign_Relationships","Product_Line",
"Product_Type","N_Parts","Assembly_Labour_Minutes","Machinery_Minutes",
"Number_of_Deliveries","Average_Delivery_Batch_Size_units","Customer_Class",
"Turnover_Range_EURO","Geographical_Area")
summary(dat)
dat$Assembly_Labour_Minutes<-as.numeric(dat$Assembly_Labour_Minutes)
dat$Machinery_Minutes<-as.numeric(dat$Machinery_Minutes)
dat[is.na(dat)] <- 0
summary(dat)
View(head(dat))
summary(dat)
write.csv(dat,"4Xdata.csv")
rm(list=ls())
source("Libraries.R")
dat<-read.csv('4Xdata.csv',header=TRUE)
View(head(dat))
dat<-dat[,-1]
View(head(dat))
CDdat<-subset(dat, select=col)
col<-c("Plant","Quantity_units","Cost_of_Goods_Sold_EURO","Total_Cost_of_Distribution",
"Product_Line","Product_Type","N_Parts",
"Number_of_Deliveries","Average_Delivery_Batch_Size_units","Customer_Class",
"Turnover_Range_EURO","Geographical_Area")
CDdat<-subset(dat, select=col)
View(head(CDdat))
smlr_Model_1 <- lm(Total_Cost_of_Distribution~.,data=CDdata)
smlr_Model_1 <- lm(Total_Cost_of_Distribution~.,data=CDdat)
summary(smlr_Model_1)
tdat <- CDdat[,-3]
head(tdat)
smlr_Model_2 <- lm(Total_Cost_of_Distribution~.,data=tdat)
summary(smlr_Model_2)
summary(CDdat)
rm(list=ls())
source("Libraries.R")
dat<-read.csv('4Xdata.csv',header=TRUE)
dat<-dat[,-1]
col<-c("Plant","Quantity_units","Cost_of_Goods_Sold_EURO","Total_Cost_of_Distribution",
"Product_Line","Product_Type","N_Parts",
"Number_of_Deliveries","Average_Delivery_Batch_Size_units","Customer_Class",
"Turnover_Range_EURO","Geographical_Area")
dat$Average_Delivery_Batch_Size_units<-as.numeric(dat$Average_Delivery_Batch_Size_units)
dat$Number_of_Deliveries<-as.numeric(dat$Number_of_Deliveries)
CDdat<-subset(dat, select=col)
summary(CDdat)
smlr_Model_1 <- lm(Total_Cost_of_Distribution~.,data=CDdat)
summary(smlr_Model_1)
tdat <- CDdat[,-3]
smlr_Model_2 <- lm(Total_Cost_of_Distribution~.,data=tdat)
summary(smlr_Model_2)
rm(tdat)
summary(CDdat)
smlr_Model_3 <- lm(Total_Cost_of_Distribution~Cost_of_Goods_Sold_EURO,data=CDdat)
summary(smlr_Model_3)
CDdat$Perc_Total_Cost_of_Distribution <- (CDdat$Total_Cost_of_Distribution/
CDdat$Cost_of_Goods_Sold_EURO)*100
View(head(CDdat))
tdat <- CDdat[,-c(3,4)]
View(head(tdat))
pmlr_Model_1 <- lm(Perc_Total_Cost_of_Distribution~.,data=tdat)
summary(CDdat)
CDdat[is.na(CDdat)] <- 0
summary(CDdat)
CDdat<-subset(dat, select=col)
CDdat$Total_Cost_of_Distribution==0
Pdat<-CDdat[CDdat$Total_Cost_of_Distribution!=0,]
summary(Pdat)
Pdat<-CDdat[CDdat$Total_Cost_of_Distribution!=0.0,]
summary(Pdat)
CDdat$Perc_Total_Cost_of_Distribution <- (CDdat$Total_Cost_of_Distribution/
CDdat$Cost_of_Goods_Sold_EURO)*100
summary(CDdat)
Pdat<-CDdat[(!is.na(CDdat$Perc_Total_Cost_of_Distribution))&
(!is.infinite(CDdat$Perc_Total_Cost_of_Distribution)),]
summary(Pdat)
tdat <- Pdat[,-c(3,4)]
pmlr_Model_1 <- lm(Perc_Total_Cost_of_Distribution~.,data=tdat)
summary(pmlr_Model_1)
View(head(Pdat))
tdat <- Pdat[,-c(4)]
pmlr_Model_2 <- lm(Perc_Total_Cost_of_Distribution~.,data=tdat)
summary(pmlr_Model_2)
tdat <- Pdat[,-c(4)]
rm(tdat)
tdat <- Pdat[,-c(4)]
pmlr_Model_2 <- lm(Perc_Total_Cost_of_Distribution~.,data=tdat)
summary(pmlr_Model_2)
rm(tdat)
rm(list=ls())
rm(list=ls())
source("Libraries.R")
dat<-read.csv('4Xdata.csv',header=TRUE)
dat<-dat[,-1]
col<-c("Plant","Quantity_units","Cost_of_Goods_Sold_EURO","Total_Cost_of_Distribution",
"Product_Line","Product_Type","N_Parts",
"Number_of_Deliveries","Average_Delivery_Batch_Size_units","Customer_Class",
"Turnover_Range_EURO","Geographical_Area")
dat$Average_Delivery_Batch_Size_units<-as.numeric(dat$Average_Delivery_Batch_Size_units)
dat$Number_of_Deliveries<-as.numeric(dat$Number_of_Deliveries)
CDdat<-subset(dat, select=col)
View(head(CDdat))
smlr_Model_1 <- lm(Total_Cost_of_Distribution~.,data=CDdat)
summary(smlr_Model_1)
tdat <- CDdat[,-3]
smlr_Model_2 <- lm(Total_Cost_of_Distribution~.,data=tdat)
summary(smlr_Model_2)
rm(tdat)
smlr_Model_3 <- lm(Total_Cost_of_Distribution~Cost_of_Goods_Sold_EURO,data=CDdat)
summary(smlr_Model_3)
CDdat$Perc_Total_Cost_of_Distribution <- (CDdat$Total_Cost_of_Distribution/
CDdat$Cost_of_Goods_Sold_EURO)*100
Pdat<-CDdat[(!is.na(CDdat$Perc_Total_Cost_of_Distribution))&
(!is.infinite(CDdat$Perc_Total_Cost_of_Distribution)),]
tdat <- Pdat[,-c(3,4)]
pmlr_Model_1 <- lm(Perc_Total_Cost_of_Distribution~.,data=tdat)
summary(pmlr_Model_1)
rm(tdat)
tdat <- Pdat[,-c(4)]
pmlr_Model_2 <- lm(Perc_Total_Cost_of_Distribution~.,data=tdat)
summary(pmlr_Model_2)
rm(tdat)
rm(list=ls())
source("Libraries.R")
dat<-read.csv('4Xdata.csv',header=TRUE)
dat<-dat[,-1]
col<-c("Plant","Quantity_units","Turnover_EURO","Cost_of_Goods_Sold_EURO",
"Total_Customer_Order_Management_Costs","Product_Line","Product_Type","N_Parts",
"Number_of_Deliveries","Average_Delivery_Batch_Size_units","Customer_Class",
"Turnover_Range_EURO","Geographical_Area")
dat$Average_Delivery_Batch_Size_units<-as.numeric(dat$Average_Delivery_Batch_Size_units)
dat$Number_of_Deliveries<-as.numeric(dat$Number_of_Deliveries)
CMdat<-subset(dat, select=col)
View(head(CMdat))
col<-c("Plant","Quantity_units","Cost_of_Goods_Sold_EURO",
"Total_Customer_Order_Management_Costs","Product_Line","Product_Type","N_Parts",
"Number_of_Deliveries","Average_Delivery_Batch_Size_units","Customer_Class",
"Turnover_Range_EURO","Geographical_Area")
dat$Average_Delivery_Batch_Size_units<-as.numeric(dat$Average_Delivery_Batch_Size_units)
dat$Number_of_Deliveries<-as.numeric(dat$Number_of_Deliveries)
CMdat<-subset(dat, select=col)
View(head(CMdat))
summary(CMdat)
smlr_Model_1 <- lm(Total_Customer_Order_Management_Costs~.,data=CMdat)
summary(smlr_Model_1)
tdat <- CMdat[,-3]
smlr_Model_2 <- lm(Total_Customer_Order_Management_Costs~.,data=tdat)
summary(smlr_Model_2)
rm(tdat)
CMdat$Perc_Total_Customer_Order_Management_Costs <- (CMdat$Total_Customer_Order_Management_Costs/
CMdat$Cost_of_Goods_Sold_EURO)*100
Pdat<-CMdat[(!is.na(CMdat$Perc_Total_Customer_Order_Management_Costs))&
(!is.infinite(CMdat$Perc_Total_Customer_Order_Management_Costs)),]
View(head(Pdat))
tdat <- Pdat[,-c(3,4)]
pmlr_Model_1 <- lm(Perc_Total_Customer_Order_Management_Costs~.,data=tdat)
summary(pmlr_Model_1)
tdat <- Pdat[,-c(4)]
pmlr_Model_1 <- lm(Perc_Total_Customer_Order_Management_Costs~.,data=tdat)
summary(pmlr_Model_1)
rm(tdat)
rm(list=ls())
rm(list=ls())
source("Libraries.R")
dat<-read.csv('4Xdata.csv',header=TRUE)
dat<-dat[,-1]
col<-c("Plant","Quantity_units","Cost_of_Goods_Sold_EURO",
"Total_Operations_Costs","Product_Line",
"Product_Type","N_Parts","Assembly_Labour_Minutes","Machinery_Minutes",
"Number_of_Deliveries","Average_Delivery_Batch_Size_units","Customer_Class",
"Turnover_Range_EURO","Geographical_Area")
dat$Average_Delivery_Batch_Size_units<-as.numeric(dat$Average_Delivery_Batch_Size_units)
dat$Number_of_Deliveries<-as.numeric(dat$Number_of_Deliveries)
summary(dat'')
summary(dat)
OCdat<-subset(dat, select=col)
View(head(OCdat))
smlr_Model_1 <- lm(Total_Operations_Costs~.,data=OCdat)
summary(smlr_Model_1)
col<-c("Plant","Quantity_units","Cost_of_Goods_Sold_EURO",
"Total_Operations_Costs","Product_Line",
"Product_Type","N_Parts","Assembly_Labour_Minutes","Machinery_Minutes",
"Number_of_Deliveries","Average_Delivery_Batch_Size_units","Customer_Class",
"Turnover_Range_EURO","Geographical_Area","Supply_Chain_Management_Costs")
OCdat<-subset(dat, select=col)
smlr_Model_2 <- lm(Total_Operations_Costs~.,data=OCdat)
summary(smlr_Model_2)
col<-c("Plant","Quantity_units","Cost_of_Goods_Sold_EURO",
"Supply_Chain_Management_Costs","Product_Line",
"Product_Type","N_Parts","Assembly_Labour_Minutes","Machinery_Minutes",
"Number_of_Deliveries","Average_Delivery_Batch_Size_units","Customer_Class",
"Turnover_Range_EURO","Geographical_Area")
col<-c("Plant","Quantity_units","Cost_of_Goods_Sold_EURO",
"Supply_Chain_Management_Costs","Product_Line",
"Product_Type","N_Parts","Assembly_Labour_Minutes","Machinery_Minutes",
"Number_of_Deliveries","Average_Delivery_Batch_Size_units","Customer_Class",
"Turnover_Range_EURO","Geographical_Area")
SCdat<-subset(dat, select=col)
smlr_Model_1 <- lm(Supply_Chain_Management_Costs~.,data=SCdat)
summary(smlr_Model_1)
plot(dat$Supply_Chain_Management_Costs~dat$Quantity_units)
plot(dat$Supply_Chain_Management_Costs~dat$Cost_of_Goods_Sold_EURO)
plot(dat$Supply_Chain_Management_Costs~dat$Total_Cost_of_Distribution)
plot(dat$Supply_Chain_Management_Costs~dat$Total_Customer_Order_Management_Costs)
SCdat<-SCdat[SCdat$Supply_Chain_Management_Costs!=0,]
smlr_Model_1 <- lm(Supply_Chain_Management_Costs~.,data=SCdat)
summary(smlr_Model_1)
lol<-lm(Supply_Chain_Management_Costs~Total_Cost_of_Distribution+Total_Customer_Order_Management_Costs,
data=dat)
summary(lol)
rm(list=ls())
rm(list=ls())
source("Libraries.R")
dat<-read.csv('4Xdata.csv',header=TRUE)
dat<-dat[,-1]
col<-c("Plant","Quantity_units","Cost_of_Goods_Sold_EURO",
"Total_Operations_Costs","Product_Line",
"Product_Type","N_Parts","Assembly_Labour_Minutes","Machinery_Minutes",
"Number_of_Deliveries","Average_Delivery_Batch_Size_units","Customer_Class",
"Turnover_Range_EURO","Geographical_Area","Supply_Chain_Management_Costs")
OCdat<-subset(dat, select=col)
summary(smlr_Model_2)
smlr_Model_2 <- lm(Total_Operations_Costs~.,data=OCdat)
summary(smlr_Model_2)
rm(list=ls())
source("Libraries.R")
dat<-read.csv('4Xdata.csv',header=TRUE)
dat<-dat[,-1]
col<-c("Plant","Quantity_units","Cost_of_Goods_Sold_EURO",
"Total_Operations_Costs","Product_Line",
"Product_Type","N_Parts","Assembly_Labour_Minutes","Machinery_Minutes",
"Number_of_Deliveries","Average_Delivery_Batch_Size_units","Customer_Class",
"Turnover_Range_EURO","Geographical_Area")
dat$Average_Delivery_Batch_Size_units<-as.numeric(dat$Average_Delivery_Batch_Size_units)
dat$Number_of_Deliveries<-as.numeric(dat$Number_of_Deliveries)
OCdat<-subset(dat, select=col)
View(head(OCdat))
smlr_Model_1 <- lm(Total_Operations_Costs~.,data=OCdat)
summary(smlr_Model_1)
col<-c("Plant","Quantity_units","Cost_of_Goods_Sold_EURO",
"Total_Operations_Costs","Product_Line",
"Product_Type","N_Parts","Assembly_Labour_Minutes","Machinery_Minutes",
"Number_of_Deliveries","Average_Delivery_Batch_Size_units","Customer_Class",
"Turnover_Range_EURO","Geographical_Area","Supply_Chain_Management_Costs")
OCdat<-subset(dat, select=col)
smlr_Model_2 <- lm(Total_Operations_Costs~.,data=OCdat)
summary(smlr_Model_2)
col<-c("Plant","Quantity_units","Cost_of_Goods_Sold_EURO",
"Supply_Chain_Management_Costs","Product_Line",
"Product_Type","N_Parts","Assembly_Labour_Minutes","Machinery_Minutes",
"Number_of_Deliveries","Average_Delivery_Batch_Size_units","Customer_Class",
"Turnover_Range_EURO","Geographical_Area")
SCdat<-subset(dat, select=col)
smlr_Model_1 <- lm(Supply_Chain_Management_Costs~.,data=SCdat)
summary(smlr_Model_1)
rm(list=ls())
rm(list=ls())
source("Libraries.R")
dat<-read.csv('4Xdata.csv',header=TRUE)
dat<-dat[,-1]
col<-c("Plant","Quantity_units","Cost_of_Goods_Sold_EURO",
"Customer_related_Issues_Costs","Product_Line",
"Product_Type","N_Parts",
"Number_of_Deliveries","Average_Delivery_Batch_Size_units","Customer_Class",
"Turnover_Range_EURO","Geographical_Area")
dat$Average_Delivery_Batch_Size_units<-as.numeric(dat$Average_Delivery_Batch_Size_units)
dat$Number_of_Deliveries<-as.numeric(dat$Number_of_Deliveries)
CSIdat<-subset(dat, select=col)
smlr_Model_1 <- lm(Customer_related_Issues_Costs~.,data=CSIdat)
summary(smlr_Model_1)
rm(list=ls())
